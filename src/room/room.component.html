
  <!-- Theme toggle in top-right corner -->
  <div class="position-fixed top-0 end-0 p-3 d-flex align-items-center gap-3" style="z-index: 1001;">
    <app-theme-toggle></app-theme-toggle>
    <div class="gong-container">
    <button 
      class="gong-switch" 
      [class.active]="setGong && gongPermissionGranted"
      [class.pending]="setGong && !gongPermissionGranted"
      (click)="toggleGong()">
      <span class="gong-label">
        @if (!gongPermissionGranted && setGong) {
          Click to Enable Sound
        } @else if (setGong) {
          Alarm ON
        } @else {
          Enable Gong of Shame
        }
      </span>
    </button>
    <div 
      class="gong-indicator" 
      [class.ringing]="gongOfShame && setGong && gongPermissionGranted" 
      [class.active]="setGong && gongPermissionGranted"
      [class.disabled]="!setGong">
      <span class="indicator-text">
        @if (gongOfShame && setGong && gongPermissionGranted) {
          Ringing!
        } @else if (setGong && gongPermissionGranted) {
          Ready
        } @else if (setGong && !gongPermissionGranted) {
          Permission Needed
        }
      </span>
    </div>
  </div>
  

</div>

  <div class="main-container" >
  
    <!-- Voter Modal -->
    @if (showVoterModal) {
      <div class="modal-overlay position-fixed top-0 start-0 w-100 h-100 bg-dark bg-opacity-50 d-flex justify-content-center align-items-center z-3">
        <div class="modal-content bg-white p-4 rounded shadow" style="min-width: 300px;">
          <h3 class="mb-3">Enter your name</h3>
          <input [(ngModel)]="userName" placeholder="Your name" class="form-control mb-3" />
          <button class="btn btn-primary w-100" (click)="submitName()">Join Room</button>
        </div>
      </div>
    }
  <div class="voting-container mx-auto">

  <!-- Voting Interface -->
  <app-voting-card
    (userDetails)="userDetails"
    (vote)="voted($event)"
    [clearVotes]="clearVotes"
  ></app-voting-card>



  <!-- Vote Results -->
  <h5 class="text-center my-4">Vote Results</h5>
  @if (settings && !settings.reveal) {
    <ul class="list-group">
      @for (voter of objectKeys(votes); track voter) {
        <li class="list-group-item d-flex justify-content-between align-items-center vote-list-item">
          <span>{{ voter }}:</span>
          @if (votes[voter].vote === "") {
            <fa-icon [icon]="faSquare"></fa-icon>
          } @else {
            <fa-icon [icon]="faCheckSquare"></fa-icon>
          }
        </li>
      }
      @empty {
        <li class="list-group-item text-center vote-list-item">
          No voters found.
        </li>
      }
    </ul>
  }


@if (settings && settings.reveal) {
  <ul class="list-group">
    @for (entry of sortedVotes; track entry.key) {
      <li class="list-group-item vote-list-item">
        <div class="row text-center align-items-center">
          
          <div class="col-4 fw-bold">
            {{ entry.key }} </div>

          <div class="col-4">
            {{ entry.value.vote }} </div>

          <div class="col-4">
            @if (entry.key == userName) {
              <reaction-card (reactionSelected)="updateEmoji($event)"></reaction-card>
            }
            @else {
              {{ entry.value.emoji }}
            }
          </div>

        </div>
      </li>
    }
    <h5 class="text-center my-4">Mode: {{currentStats.mode}}</h5>
  </ul>
}


 <!-- Bottom Buttons -->
  <div class="bottom-buttons mt-5">
    <!-- Left -->
    <div class="d-flex gap-2">
      <button class="btn btn-primary" (click)="revealClicked()">
        {{ reveal ? 'Hide' : 'Reveal' }}
      </button>
      <button class="btn btn-danger" (click)="clearClicked()">Clear Votes</button>
    </div>
    <!-- Right -->
    <div>
      <button class="btn btn-primary" (click)="exitRoom()">Exit Room</button>
    </div>
  </div>

<app-barchart (statsUpdated)="handleStatsChange($event)"></app-barchart>



</div>
<app-barchart (statsUpdated)="handleStatsChange($event)"></app-barchart>



</div>
